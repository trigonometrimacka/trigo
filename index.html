<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TRIGO PRO - Mobile App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #e2e8f0; overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Sayfa GeÃ§iÅŸ AnimasyonlarÄ± */
        .page-section {
            display: none;
            height: 100vh;
            overflow-y: auto;
            padding-bottom: 80px; /* MenÃ¼ payÄ± */
            animation: fadeIn 0.4s ease-out;
        }
        .page-section.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hamburger MenÃ¼ Animasyonu */
        #sidebar { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); transform: translateX(-100%); }
        #sidebar.open { transform: translateX(0); }
        .overlay { display: none; }
        .overlay.active { display: block; }

        /* Neon Efektler */
        .neon-green { text-shadow: 0 0 10px rgba(74, 222, 128, 0.6); }
        
        /* Slider Styling */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #4ade80; margin-top: -8px; box-shadow: 0 0 10px #4ade80;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; background: #333; border-radius: 2px;
        }
    </style>
</head>
<body>

    <header class="fixed top-0 left-0 right-0 h-16 bg-black/90 backdrop-blur border-b border-gray-800 flex items-center justify-between px-5 z-50">
        <button id="menu-btn" class="text-white text-2xl hover:text-green-400 transition">
            <i class="fa-solid fa-bars"></i>
        </button>
        <h1 class="text-xl font-bold tracking-wider neon-green">TRIGO<span class="text-white font-light">PRO</span></h1>
        <div class="w-6"></div> </header>

    <div id="overlay" class="overlay fixed inset-0 bg-black/80 z-40 backdrop-blur-sm" onclick="toggleMenu()"></div>
    <aside id="sidebar" class="fixed top-0 left-0 bottom-0 w-64 bg-gray-900 border-r border-gray-800 z-50 shadow-2xl pt-20 px-4 flex flex-col">
        <nav class="space-y-2">
            <button onclick="navTo('home')" class="w-full text-left p-4 rounded-xl hover:bg-gray-800 transition flex items-center gap-3 text-white font-bold">
                <i class="fa-solid fa-graduation-cap text-green-400"></i> Hikaye & MantÄ±k
            </button>
            <button onclick="navTo('lab')" class="w-full text-left p-4 rounded-xl hover:bg-gray-800 transition flex items-center gap-3 text-gray-300">
                <i class="fa-solid fa-wave-square text-blue-400"></i> SinÃ¼s Lab & Kod
            </button>
            <button onclick="navTo('measure')" class="w-full text-left p-4 rounded-xl hover:bg-gray-800 transition flex items-center gap-3 text-gray-300">
                <i class="fa-solid fa-ruler-combined text-yellow-400"></i> Saha Ã–lÃ§Ã¼mÃ¼
            </button>
        </nav>
        <div class="mt-auto mb-8 p-4 bg-gray-800 rounded-xl">
            <p class="text-xs text-gray-400">GeliÅŸtirici</p>
            <p class="text-sm font-mono text-green-400">Gemini AI</p>
        </div>
    </aside>

    <main class="pt-20 px-4 h-screen">

        <section id="page-home" class="page-section active">
            
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-white mb-2">Her Åžey GÃ¶lgelerle BaÅŸladÄ±</h2>
                <p class="text-gray-400 text-sm leading-relaxed mb-4">
                    Milattan Ã¶nce MÄ±sÄ±rlÄ±lar ve YunanlÄ±lar, piramitlerin boyunu Ã¶lÃ§mek iÃ§in gÃ¼neÅŸin oluÅŸturduÄŸu gÃ¶lgeyi kullandÄ±lar.
                    <br><br>
                    <span class="text-green-400 font-bold">MantÄ±k basitti:</span> Yere bir Ã§ubuk dik. Ã‡ubuÄŸun boyunu ve gÃ¶lgesini biliyorsan, aÃ§Ä±yÄ± bulabilirsin. Bu oranlara isim verdiler.
                </p>
                <div class="flex gap-2 text-xs overflow-x-auto pb-2">
                    <span class="bg-gray-800 px-3 py-1 rounded-full border border-gray-700 whitespace-nowrap">ðŸ“œ Thales (M.Ã– 600)</span>
                    <span class="bg-gray-800 px-3 py-1 rounded-full border border-gray-700 whitespace-nowrap">ðŸ”­ Hipparchus (Trigo'nun BabasÄ±)</span>
                </div>
            </div>

            <div class="bg-gray-900 rounded-2xl border border-gray-800 p-1 mb-6 shadow-2xl relative overflow-hidden">
                <div class="absolute top-2 left-3 z-10">
                    <span class="text-[10px] bg-green-900/50 text-green-400 px-2 py-1 rounded border border-green-500/30 uppercase tracking-widest font-bold">CanlÄ± SimÃ¼lasyon</span>
                </div>
                <canvas id="introCanvas" class="w-full h-64 bg-black rounded-xl"></canvas>
                <div class="p-4">
                    <h3 class="font-bold text-white text-lg">Daireden Dalgaya GeÃ§iÅŸ</h3>
                    <p class="text-xs text-gray-400 mt-1">
                        Soldaki Ã§emberde dÃ¶nen nokta (aÃ§Ä±), saÄŸ tarafta zamanla ilerleyen bir dalgaya dÃ¶nÃ¼ÅŸÃ¼r. Ä°ÅŸte <strong class="text-green-400">SinÃ¼s</strong> budur: DÃ¶nen bir ÅŸeyin yÃ¼ksekliÄŸinin zamanla deÄŸiÅŸimi.
                    </p>
                </div>
            </div>

            <div class="space-y-3">
                <div class="bg-gray-800/50 p-4 rounded-xl border-l-4 border-red-500">
                    <h4 class="font-bold text-white text-sm">SinÃ¼s (Sin)</h4>
                    <p class="text-xs text-gray-400">YÃ¼kseklik demektir. KarÅŸÄ± / HipotenÃ¼s.</p>
                </div>
                <div class="bg-gray-800/50 p-4 rounded-xl border-l-4 border-blue-500">
                    <h4 class="font-bold text-white text-sm">KosinÃ¼s (Cos)</h4>
                    <p class="text-xs text-gray-400">GeniÅŸlik/Mesafe demektir. KomÅŸu / HipotenÃ¼s.</p>
                </div>
            </div>

            <button onclick="navTo('lab')" class="w-full mt-8 bg-green-600 hover:bg-green-500 text-white font-bold py-4 rounded-xl transition shadow-lg shadow-green-900/40">
                Hadi Koda DÃ¶kelim â†’
            </button>
        </section>

        <section id="page-lab" class="page-section">
            <h2 class="text-2xl font-bold text-white mb-4">Laboratuvar</h2>
            <p class="text-gray-400 text-sm mb-6">YazÄ±lÄ±mda trigonometri ses, grafik ve oyun fiziÄŸi demektir. AÅŸaÄŸÄ±daki kodu Ã§alÄ±ÅŸtÄ±r.</p>

            <div class="bg-[#1e1e1e] p-4 rounded-t-xl border border-gray-700 font-mono text-xs overflow-x-auto">
                <span class="text-purple-400">const</span> osc = ctx.<span class="text-blue-400">createOscillator</span>();<br>
                osc.<span class="text-yellow-400">type</span> = <span class="text-green-400">'sine'</span>;<br>
                osc.frequency.<span class="text-yellow-400">value</span> = <span id="code-freq" class="text-white font-bold">440</span>;<br>
                osc.<span class="text-blue-400">start</span>();
            </div>

            <div class="bg-gray-900 border border-t-0 border-gray-700 rounded-b-xl p-5 mb-6">
                
                <canvas id="oscCanvas" class="w-full h-24 bg-black rounded-lg border border-gray-800 mb-4 shadow-[inset_0_0_20px_rgba(0,0,0,0.8)]"></canvas>

                <div class="flex justify-between text-xs text-gray-500 mb-2 uppercase font-bold tracking-wider">
                    <span>KalÄ±n Ses</span>
                    <span>Ä°nce Ses</span>
                </div>
                <input type="range" id="freq-slider" min="100" max="1000" value="440" class="w-full mb-6">
                
                <button id="btn-audio" class="w-full py-4 rounded-xl font-bold bg-gray-800 text-white border border-gray-600 hover:bg-gray-700 active:scale-95 transition flex justify-center items-center gap-3">
                    <i class="fa-solid fa-play"></i>
                    <span>Kodu Ã‡alÄ±ÅŸtÄ±r & Duy</span>
                </button>
            </div>

            <div class="bg-blue-900/20 p-4 rounded-xl border border-blue-500/30">
                <h3 class="text-blue-400 font-bold text-sm mb-1"><i class="fa-solid fa-lightbulb"></i> Bilgi</h3>
                <p class="text-gray-400 text-xs">HoparlÃ¶rÃ¼n iÃ§indeki mÄ±knatÄ±s, buradaki sinÃ¼s koduna gÃ¶re ileri-geri hareket ederek havayÄ± titreÅŸtirir ve sesi oluÅŸturur.</p>
            </div>
        </section>

        <section id="page-measure" class="page-section h-full flex flex-col">
            <div class="flex-none">
                <h2 class="text-2xl font-bold text-white mb-2">MÃ¼hendis Modu</h2>
                <p class="text-gray-400 text-sm mb-6">Telefon sensÃ¶rlerini kullanarak gerÃ§ek dÃ¼nya Ã¶lÃ§Ã¼mÃ¼ yap.</p>
            </div>

            <div id="measure-setup" class="flex-1 bg-gray-900 rounded-2xl border border-gray-800 p-6 flex flex-col justify-center gap-4">
                <div class="text-center mb-4">
                    <i class="fa-solid fa-building text-4xl text-gray-600"></i>
                </div>
                
                <div>
                    <label class="text-xs text-green-400 uppercase font-bold ml-1">Hedefe UzaklÄ±k (m)</label>
                    <input type="number" id="dist-input" value="10" class="w-full bg-black border border-gray-700 text-white p-4 rounded-xl text-lg mt-1 focus:border-green-500 outline-none">
                </div>
                <div>
                    <label class="text-xs text-green-400 uppercase font-bold ml-1">Kendi Boyun (m)</label>
                    <input type="number" id="height-input" value="1.75" class="w-full bg-black border border-gray-700 text-white p-4 rounded-xl text-lg mt-1 focus:border-green-500 outline-none">
                </div>

                <button onclick="startMeasure()" class="mt-4 bg-green-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-900/50">
                    Ã–LÃ‡ÃœMÃœ BAÅžLAT
                </button>
            </div>

            <div id="measure-live" class="hidden flex-1 relative bg-black rounded-2xl border border-gray-800 overflow-hidden">
                <div class="absolute inset-0 flex flex-col items-center justify-center z-10">
                    <div class="w-full h-[1px] bg-red-500/50 absolute top-1/2"></div>
                    <div class="h-full w-[1px] bg-red-500/50 absolute left-1/2"></div>
                    <div class="w-48 h-48 border-2 border-dashed border-green-500/30 rounded-full animate-pulse"></div>
                    
                    <div class="mt-32 text-center bg-black/60 backdrop-blur p-4 rounded-xl border border-gray-700">
                        <div class="text-gray-400 text-xs">YÃœKSEKLÄ°K</div>
                        <div id="result-meters" class="text-4xl font-mono font-bold text-white">0.00m</div>
                        <div id="angle-debug" class="text-xs text-green-500 mt-1">AÃ§Ä±: 0Â°</div>
                    </div>
                </div>

                <div class="absolute inset-0 bg-gray-800 opacity-20"></div>
                
                <button onclick="stopMeasure()" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-8 py-3 rounded-full font-bold shadow-xl z-20">
                    DURDUR
                </button>
            </div>
        </section>

    </main>

    <script>
        // --- NAVÄ°GASYON & UI MANTIÄžI ---
        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        let currentLoop = null; // Aktif animasyon dÃ¶ngÃ¼sÃ¼nÃ¼ tutar

        function toggleMenu() {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }
        
        menuBtn.addEventListener('click', toggleMenu);

        function navTo(pageId) {
            // 1. MenÃ¼yÃ¼ kapat
            if(sidebar.classList.contains('open')) toggleMenu();

            // 2. SayfalarÄ± deÄŸiÅŸtir
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');

            // 3. Ã–nceki dÃ¶ngÃ¼leri/iÅŸlemleri temizle
            cancelAnimationFrame(currentLoop);
            stopAudio();
            stopMeasure();

            // 4. Yeni sayfa iÃ§in Ã¶zel baÅŸlatÄ±cÄ±lar
            if(pageId === 'home') startIntroAnimation();
            if(pageId === 'lab') drawOscilloscope(); // Sadece Ã§izim, ses deÄŸil
        }

        // --- SAYFA 1: INTRO ANÄ°MASYONU (Canvas) ---
        function startIntroAnimation() {
            const canvas = document.getElementById('introCanvas');
            const ctx = canvas.getContext('2d');
            
            // Retina ekranlar iÃ§in keskinlik ayarÄ±
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);

            let angle = 0;
            const history = []; // Dalga kuyruÄŸu

            function animate() {
                const w = rect.width;
                const h = rect.height;
                const cx = w * 0.25; // Ã‡ember merkezi X
                const cy = h * 0.5;  // Ã‡ember merkezi Y
                const radius = h * 0.3;

                ctx.clearRect(0, 0, w, h);

                // 1. Ã‡emberi Ã‡iz
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(cx, cy, radius, 0, Math.PI * 2);
                ctx.stroke();

                // 2. DÃ¶nen NoktayÄ± Hesapla
                const px = cx + Math.cos(angle) * radius;
                const py = cy + Math.sin(angle) * radius;

                // 3. YarÄ±Ã§ap Ã§izgisi
                ctx.strokeStyle = '#4ade80'; // Neon YeÅŸil
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(px, py);
                ctx.stroke();

                // 4. Nokta
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(px, py, 4, 0, Math.PI * 2);
                ctx.fill();

                // 5. KarÅŸÄ±ya Ä°zdÃ¼ÅŸÃ¼m Ã‡izgisi (Ã‡emberden Dalgaya)
                const waveStartX = w * 0.5;
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(px, py);
                ctx.lineTo(waveStartX, py);
                ctx.stroke();
                ctx.setLineDash([]);

                // 6. DalgayÄ± Kaydet ve Ã‡iz
                history.unshift(py); // Yeni Y deÄŸerini ekle
                if(history.length > w * 0.5) history.pop(); // Ã‡ok uzarsa sil

                ctx.strokeStyle = '#4ade80';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for(let i = 0; i < history.length; i++) {
                    ctx.lineTo(waveStartX + i, history[i]);
                }
                ctx.stroke();

                angle -= 0.05; // DÃ¶nÃ¼ÅŸ hÄ±zÄ±
                currentLoop = requestAnimationFrame(animate);
            }
            animate();
        }

        // --- SAYFA 2: LAB SES & SÄ°NÃœS ---
        let audioCtx;
        let oscillator;
        let isPlaying = false;

        const btnAudio = document.getElementById('btn-audio');
        const freqSlider = document.getElementById('freq-slider');
        const codeFreqDisplay = document.getElementById('code-freq');
        const oscCanvas = document.getElementById('oscCanvas');
        const oscCtx = oscCanvas.getContext('2d');

        // Lab canvas boyutlandÄ±rma
        oscCanvas.width = oscCanvas.clientWidth * 2;
        oscCanvas.height = oscCanvas.clientHeight * 2;

        freqSlider.addEventListener('input', (e) => {
            codeFreqDisplay.innerText = e.target.value;
            if(oscillator) oscillator.frequency.value = e.target.value;
        });

        btnAudio.addEventListener('click', () => {
            if(isPlaying) stopAudio();
            else startAudio();
        });

        function startAudio() {
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            
            oscillator = audioCtx.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.value = freqSlider.value;
            
            // Sesi yumuÅŸatmak iÃ§in Gain (Ses seviyesi) Node
            const gainNode = audioCtx.createGain();
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime); // %10 ses seviyesi (kulak patlamasÄ±n)
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.start();
            isPlaying = true;
            
            btnAudio.innerHTML = `<i class="fa-solid fa-stop"></i> <span>Kodu Durdur</span>`;
            btnAudio.classList.remove('bg-gray-800');
            btnAudio.classList.add('bg-red-600');
            
            drawOscilloscope();
        }

        function stopAudio() {
            if(oscillator) {
                oscillator.stop();
                oscillator = null;
            }
            isPlaying = false;
            btnAudio.innerHTML = `<i class="fa-solid fa-play"></i> <span>Kodu Ã‡alÄ±ÅŸtÄ±r & Duy</span>`;
            btnAudio.classList.add('bg-gray-800');
            btnAudio.classList.remove('bg-red-600');
        }

        function drawOscilloscope() {
            if(document.getElementById('page-lab').style.display === 'none') return;

            const w = oscCanvas.width;
            const h = oscCanvas.height;
            const freq = freqSlider.value;
            
            oscCtx.fillStyle = 'black';
            oscCtx.fillRect(0, 0, w, h);
            
            oscCtx.lineWidth = 4;
            oscCtx.strokeStyle = isPlaying ? '#4ade80' : '#333'; // Ã‡alÄ±yorsa yeÅŸil, duruyorsa gri
            
            oscCtx.beginPath();
            const time = Date.now() / 1000;
            
            for(let x = 0; x < w; x++) {
                // GÃ¶rselleÅŸtirme iÃ§in suni dalga
                const wavelength = isPlaying ? (20000 / freq) : 100;
                const amplitude = isPlaying ? (h/3) : 5;
                const speed = isPlaying ? (time * freq / 5) : 0;

                const y = (h/2) + Math.sin((x/wavelength) + speed) * amplitude;
                if(x===0) oscCtx.moveTo(x, y);
                else oscCtx.lineTo(x, y);
            }
            oscCtx.stroke();
            
            if(isPlaying) requestAnimationFrame(drawOscilloscope);
        }

        // --- SAYFA 3: Ã–LÃ‡ÃœM SENSÃ–RLERÄ° ---
        function startMeasure() {
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(resp => {
                        if (resp === 'granted') initSensor();
                        else alert('Ä°zin verilmedi kanka, Ã¶lÃ§emem.');
                    })
                    .catch(console.error);
            } else {
                initSensor();
            }
        }

        function initSensor() {
            document.getElementById('measure-setup').classList.add('hidden');
            document.getElementById('measure-live').classList.remove('hidden');
            document.getElementById('measure-live').classList.add('flex');
            
            window.addEventListener('deviceorientation', handleOrientation);
        }

        function stopMeasure() {
            window.removeEventListener('deviceorientation', handleOrientation);
            document.getElementById('measure-setup').classList.remove('hidden');
            document.getElementById('measure-live').classList.add('hidden');
            document.getElementById('measure-live').classList.remove('flex');
        }

        function handleOrientation(e) {
            // Beta: CihazÄ±n Ã¶ne/arkaya eÄŸimi (-180, 180)
            let beta = e.beta;
            
            // Basit aÃ§Ä± sabitleme (0 ile 90 arasÄ±)
            if(beta > 90) beta = 90;
            if(beta < 0) beta = 0;
            
            // Hesaplama
            // Tan(aÃ§Ä±) = KarÅŸÄ±(YÃ¼kseklik) / KomÅŸu(Mesafe)
            // YÃ¼kseklik = Tan(aÃ§Ä±) * Mesafe + Boy
            
            const dist = parseFloat(document.getElementById('dist-input').value);
            const height = parseFloat(document.getElementById('height-input').value);
            
            const radian = beta * (Math.PI / 180);
            const calcHeight = (Math.tan(radian) * dist) + height;
            
            document.getElementById('result-meters').innerText = calcHeight.toFixed(2) + "m";
            document.getElementById('angle-debug').innerText = `EÄŸim AÃ§Ä±sÄ±: ${beta.toFixed(1)}Â°`;
        }

        // BaÅŸlangÄ±Ã§ animasyonu
        startIntroAnimation();

    </script>
</body>
</html>
