<!DOCTYPE html>
<html lang="tr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Pro Osiloskop ve Trigonometrik Analiz</title>
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  /* Yeni Renk Paleti (AÃ§Ä±k Tema) */
Â  Â  Â  Â  Â  Â  --ana-renk: #5B86A5; /* Profesyonel, yumuÅŸak mavi */
Â  Â  Â  Â  Â  Â  --arka-plan: #FDFBF5; /* Ã‡ok aÃ§Ä±k bej/krem */
Â  Â  Â  Â  Â  Â  --kutu-arka-plan: #FFFFFF; /* Beyaz kartlar */
Â  Â  Â  Â  Â  Â  --kutu-kenar: #E0E0E0; /* AÃ§Ä±k gri kenarlÄ±k */
Â  Â  Â  Â  Â  Â  --metin-rengi: #333333; /* Koyu gri metin */
Â  Â  Â  Â  Â  Â  --ikincil-metin: #666666;
Â  Â  Â  Â  Â  Â  --kutu-golge: rgba(0, 0, 0, 0.05);
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  background-color: var(--arka-plan);
Â  Â  Â  Â  Â  Â  color: var(--metin-rengi);
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  h1, h2, h3 {
Â  Â  Â  Â  Â  Â  color: #2D5D7A; /* BaÅŸlÄ±klar iÃ§in daha koyu bir mavi */
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid #DDDDDD; /* Daha ince kenarlÄ±k */
Â  Â  Â  Â  Â  Â  padding-bottom: 8px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .layout-container {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 1250px;
Â  Â  Â  Â  Â  Â  gap: 20px;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  margin-left: auto;
Â  Â  Â  Â  Â  Â  margin-right: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  .panel {
Â  Â  Â  Â  Â  Â  background-color: var(--kutu-arka-plan);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--kutu-kenar);
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px var(--kutu-golge); /* Daha yumuÅŸak gÃ¶lge */
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  .kontrol-paneli {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  _ Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  _ Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  background-color: #F9F9F9; /* Panelle aynÄ± deÄŸil, hafif farklÄ± */
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--kutu-kenar);
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  margin-left: auto;
Â  Â  Â  Â  Â  Â  margin-right: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  .kontrol-paneli button {
Â  Â  Â  Â  Â  Â  background-color: var(--ana-renk);
Â  Â  Â  Â  Â  Â  color: var(--arka-plan); /* AÃ§Ä±k renk arka plan Ã¼stÃ¼ne */
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s;
Â  Â  Â  Â  Â  Â  margin: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .kontrol-paneli button:hover {
Â  Â  Â  Â  Â  Â  background-color: #4a708c; /* Ana rengin koyusu */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .kontrol-paneli button:disabled {
Â  Â  Â  Â  Â  Â  background-color: #B0B0B0;
Â  Â  Â  Â  Â  Â  color: #F0F0F0;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  canvas {
Â  Â  Â  Â  Â  Â  background-color: #FFFFFF; /* Siyah deÄŸil beyaz */
Â  Â  Â  Â  Â  Â  border: 1px solid var(--kutu-kenar); /* Ä°nce gri kenar */
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #analysisCanvas {
Â  Â  Â  Â  Â  Â  cursor: crosshair;
Â  Â  Â  Â  }

Â  Â  Â  Â  #trigPanel {
Â  Â  Â  Â  Â  Â  font-family: 'Consolas', 'Courier New', monospace;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  background-color: #F8F8F8; /* Ã‡ok aÃ§Ä±k gri */
Â  Â  Â  Â  Â  Â  border: 1px solid var(--kutu-kenar); /* DÃ¼z kenar */
Â  Â  Â  Â  Â  Â  color: var(--metin-rengi);
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px; /* KÃ¶ÅŸeleri yumuÅŸat */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #trigPanel pre {
Â  Â  Â  Â  Â  Â  white-space: pre-wrap;
Â  Â  Â  Â  Â  Â  word-wrap: break-word;
Â  Â  Â  Â  Â  Â  font-size: 0.95em;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* AKORDÄ°YON (Ã‡alÄ±ÅŸma MantÄ±ÄŸÄ±) STÄ°LÄ° */
Â  Â  Â  Â  .accordion {
Â  Â  Â  Â  Â  Â  background-color: #F0F0F0; /* AÃ§Ä±k gri */
Â  Â  Â  Â  Â  Â  color: #2D5D7A; /* Koyu mavi metin */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  padding: 18px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  border: 1px solid #E0E0E0;
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  transition: 0.4s;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }

Â  Â  Â  Â  .active, .accordion:hover {
Â  Â  Â  Â  Â  Â  background-color: #E5E5E5; /* Hover rengi */
Â  Â  Â  Â  }

Â  Â  Â  Â  .accordion::before {
Â  Â  Â  Â  Â  Â  content: '+';
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: var(--metin-rengi); /* Siyah artÄ± */
Â  Â  Â  Â  Â  Â  float: right;
Â  Â  Â  Â  Â  Â  margin-left: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .active::before {
Â  Â  Â  Â  Â  Â  content: "âˆ’";
Â  Â  Â  Â  }

Â  Â  Â  Â  .accordion-panel {
Â  Â  Â  Â  Â  Â  padding: 0 18px;
Â  Â  Â  Â  Â  Â  background-color: var(--kutu-arka-plan);
Â  Â  Â  Â  Â  Â  max-height: 0;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  transition: max-height 0.2s ease-out;
Â  Â  Â  Â  Â  Â  border-left: 3px solid var(--ana-renk); /* Mavi Ã§izgi */
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid var(--kutu-kenar);
Â  Â  Â  Â  }
Â  Â  Â  Â  .accordion-panel p, .accordion-panel ol {
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  	color: var(--ikincil-metin);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* ESTETÄ°K KAYDIRMA Ã‡UBUÄU (SLIDER) STÄ°LÄ° */
Â  Â  Â  Â  .slider-grup {
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  padding-top: 10px;
Â  Â  Â  Â  Â  Â  border-top: 1px solid var(--kutu-kenar);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .slider-grup label {
Â  Â  Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  Â  Â  color: var(--ikincil-metin); /* Metin rengi */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .slider-grup input[type="range"] {
Â  Â  Â  Â  Â  Â  -webkit-appearance: none;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 6px; /* Daha ince, resimdeki gibi */
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  background: #E0E0E0; /* AÃ§Ä±k gri yol */
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  opacity: 0.9;
Â  Â  Â  Â  Â  Â  -webkit-transition: .2s;
Â  Â  Â  Â  Â  Â  transition: opacity .2s;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .slider-grup input[type="range"]:hover {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  }

Â  Â  Â  Â  .slider-grup input[type="range"]::-webkit-slider-thumb {
Â  Â  Â  Â  Â  Â  -webkit-appearance: none;
Â  Â  Â  Â  Â  Â  appearance: none;
Â  Â  Â  Â  Â  Â  width: 20px; /* Biraz daha kÃ¼Ã§Ã¼k */
Â  Â  Â  Â  Â  Â  height: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  background: var(--ana-renk); /* Mavi tutamaÃ§ */
Â  Â  Â  Â  Â  Â  border: 3px solid var(--kutu-arka-plan); /* Beyaz kenar */
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 5px rgba(0,0,0,0.1); /* Hafif gÃ¶lge */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  .slider-grup input[type="range"]::-moz-range-thumb {
Â  Â  Â  Â  Â  Â  width: 20px;
Â  Â  Â  Â  Â  Â  height: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  background: var(--ana-renk);
Â  Â  Â  Â  Â  Â  border: 3px solid var(--kutu-arka-plan);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 5px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .slider-etiket-konteyner {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  font-size: 0.8em;
Â  Â  Â  Â  Â  Â  color: #888; /* Daha aÃ§Ä±k gri */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .osiloskop-bilgi {
Â  Â  Â  Â  Â  Â  font-family: 'Consolas', monospace;
Â  Â  Â  Â  Â  Â  color: var(--ikincil-metin); /* Koyu yeÅŸil yerine yumuÅŸak gri */
Â  Â  Â  Â  Â  Â  background: none; /* Arka plan yok */
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  border-radius: 0;
Â  Â  Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  Â  Â  text-align: left; /* SaÄŸa yaslÄ± deÄŸil */
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px; /* Canvas'tan Ã¶nce boÅŸluk */
Â  Â  Â  Â  }

Â  Â  </style>
</head>
<body>

Â  Â  <h1>ğŸ”Š Pro Osiloskop ve Trigonometrik Analiz ğŸš€</h1>

Â  Â  <div class="panel" style="max-width: 1250px; margin-left: auto; margin-right: auto;">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button class="accordion">Bu Site Ne Ä°ÅŸe Yarar? (Ã–zet)</button>
Â  Â  Â  Â  <div class="accordion-panel">
Â  Â  Â  Â  Â  Â  <p>Bu araÃ§, sesinizi profesyonel bir osiloskop gibi analiz etmenizi saÄŸlar. Sesi sadece canlÄ± gÃ¶stermekle kalmaz, 'Yakala' butonuna bastÄ±ÄŸÄ±nÄ±zda sesin bÃ¼yÃ¼k bir parÃ§asÄ±nÄ± (yaklaÅŸÄ±k 186 milisaniye) hafÄ±zaya alÄ±r. Bu yakalanan ses Ã¼zerinde **ileri-geri sarma** yaparak gezinebilir ve tÄ±kladÄ±ÄŸÄ±nÄ±z noktanÄ±n eÄŸimini (yani `tan(Î¸)` deÄŸerini) anÄ±nda hesaplayabilirsiniz.</p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="accordion">NasÄ±l KullanÄ±lÄ±r? (AdÄ±m AdÄ±m)</button>
Â  Â  Â  Â  <div class="accordion-panel">
Â  Â  Â  Â  Â  Â  <ol>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Gereklilik:</strong> Bu sayfanÄ±n `http://localhost` veya `https://` adresinden aÃ§Ä±ldÄ±ÄŸÄ±ndan emin olun (Ã–rn: VS Code + Live Server).</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>BaÅŸlat:</strong> 'ğŸ™ï¸ Mikrofonu BaÅŸlat' butonuna basÄ±n. TarayÄ±cÄ± sizden **mikrofon izni** isteyecektir. Ä°zin verin.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Ä°zle:</strong> 'CanlÄ± AkÄ±ÅŸ' ekranÄ±nda sesi izleyin. 'CanlÄ± Dalga DetayÄ±' kaydÄ±racÄ± ile canlÄ± akÄ±ÅŸÄ±n hÄ±zÄ±nÄ±/detayÄ±nÄ± ayarlayÄ±n.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Yakala:</strong> 'ğŸ“¸ AnlÄ±k Ses Yakala' butonuna basÄ±n. O anki ses, "Analiz EkranÄ±"na aktarÄ±lacaktÄ±r.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Geri/Ä°leri Sar:</strong> 'Analiz EkranÄ±' altÄ±ndaki 'Yakalanan Sesi KaydÄ±r' kaydÄ±racÄ± ile hafÄ±zaya alÄ±nan sesin iÃ§inde gezinin.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Analiz Et:</strong> SarÄ± dalga Ã¼zerinde bir noktaya tÄ±klayÄ±n.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Hesapla:</strong> En alttaki panelde o noktanÄ±n eÄŸim (AkÄ±ÅŸ HÄ±zÄ±), aÃ§Ä± ve trigonometrik ($\sin$, $\cos$, $\tan$) deÄŸerlerini gÃ¶rÃ¼n.</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Referans Ekle:</strong> 'Analiz EkranÄ±'ndaki 'Referans SinÃ¼s DalgasÄ±' kontrolleri ile kendi dalganÄ±zÄ± oluÅŸturup yakaladÄ±ÄŸÄ±nÄ±z sesle karÅŸÄ±laÅŸtÄ±rÄ±n.</li>
Â  Â  Â  Â  Â  Â  </ol>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="accordion">Trigonometri Bu Ä°ÅŸin Neresinde?</button>
Â  Â  Â  Â  <div class="accordion-panel">
Â  Â  Â  Â  Â  Â  <p>EÄŸim, hÄ±z demektir. Sesin eÄŸimi, sesin o anda ne kadar hÄ±zlÄ± deÄŸiÅŸtiÄŸini gÃ¶sterir. Trigonometride ise eÄŸim, **Tanjant (tan)** demektir.</p>
Â  Â  Â  Â  Â  Â  <p style="font-family: 'Consolas', monospace; font-size: 1.2em; text-align: center; color: var(--ana-renk);">
Â  Â  Â  Â  Â  Â  Â  Â  EÄŸim (m) = tan(Î¸)
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <p>AyrÄ±ca, eklediÄŸiniz 'Referans SinÃ¼s DalgasÄ±'nÄ±n frekansÄ±nÄ± ($f$) siz belirlersiniz. Biz de o dalganÄ±n **Periyodunu ($T$)** hesaplarÄ±z. Ã‡Ã¼nkÃ¼ aralarÄ±nda doÄŸrudan trigonometrik bir iliÅŸki vardÄ±r: $T = 1/f$.</p>
Â  Â  Â  Â  </div>
Â  Â  </div>


Â  Â  <div class="kontrol-paneli">
Â  Â  Â  Â  <button id="startStopButton">ğŸ™ï¸ Mikrofonu BaÅŸlat</button>
Â  Â  Â  Â  <button id="captureButton" disabled>ğŸ“¸ AnlÄ±k Ses Yakala (Analiz Et)</button>
Â  Â  </div>

Â  Â  <div class="layout-container">
Â  Â  Â  Â  <div class="panel">
Â  Â  Â  Â  Â  Â  <h2>CanlÄ± AkÄ±ÅŸ</h2>
Â  Â  Â  Â  Â  Â  <div class="osiloskop-bilgi" id="liveInfo">Detay: 2048</div>
Â  Â  Â  Â  Â  Â  <canvas id="liveCanvas"></canvas>
Â  Â  Â  Â  Â  Â  <div class="slider-grup">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="fftSlider">CanlÄ± Dalga DetayÄ± (FFT Boyutu)</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="range" id="fftSlider" min="0" max="5" value="2">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="slider-etiket-konteyner">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>HÄ±zlÄ± / Az Detay</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>YavaÅŸ / Ã‡ok Detay</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="panel">
Â  Â  Â  Â  Â  Â  <h2>Analiz EkranÄ±</h2>
Â  Â  Â  Â  Â  Â  <div class="osiloskop-bilgi" id="analysisInfo">Toplam Yakalanan SÃ¼re: --- ms</div>
Â  Â  Â  Â  Â  Â  <canvas id="analysisCanvas"></canvas>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="slider-grup">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="scrollSlider">Yakalanan Sesi KaydÄ±r (Ä°leri/Geri Sar)</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="range" id="scrollSlider" min="0" max="1000" value="0">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="slider-grup">
Â  Â  Â  Â  Â  Â  Â  Â  <label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="showRefWave"> Referans SinÃ¼s DalgasÄ±nÄ± GÃ¶ster
Â  Â  Â  Â  Â  Â  Â  _ </label>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display: flex; gap: 20px; margin-top: 10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex-basis: 50%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="freqSlider">Frekans (DÃ¶ngÃ¼ SayÄ±sÄ±)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="range" id="freqSlider" min="1" max="50" value="5">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex-basis: 50%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="ampSlider">Genlik (YÃ¼kseklik)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="range" id="ampSlider" min="0" max="1" value="0.5" step="0.01">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="panel" id="trigPanel" style="max-width: 1250px; margin-left: auto; margin-right: auto;">
Â  Â  Â  Â  <div style="display: flex; flex-wrap: wrap; gap: 20px;">
Â  Â  Â  Â  Â  Â  <div style="flex: 1; min-width: 300px;">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ“‰ Noktasal AkÄ±ÅŸ HÄ±zÄ± (EÄŸim)</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <pre id="analysisData">
TÄ±kladÄ±ÄŸÄ±n Nokta:
Â  Zaman (t): ---
Â  Genlik (y): ---

Nokta EÄŸim (TeÄŸet) Bilgileri:
Â  EÄŸim (m) - **AKIÅ HIZI**: ---
Â  AÃ§Ä± (Î¸) [Radyan]: ---
Â  AÃ§Ä± (Î¸) [Derece]: ---

Trigonometrik DeÄŸerler:
Â  tan(Î¸) = EÄŸim (m)
Â  sin(Î¸) = ---
Â  cos(Î¸) = ---
Â  cot(Î¸) = ---
Â  Â  Â  Â  Â  Â  Â  Â  </pre>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="flex: 1; min-width: 300px;">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ§® Referans Dalga Bilgisi</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <pre id="refWaveData">
Ayarlar:
Â  Frekans (f): --- (DÃ¶ngÃ¼/Ekran)
Â  Genlik (A): ---

Hesaplamalar:
Â  Periyot (T): --- (Ekran GeniÅŸliÄŸi / f)
Â  Dalga Denklemi:
Â  Â  y(t) = A * sin(2 * Ï€ * f * t)
Â  Â  Â  Â  Â  Â  Â  Â  </pre>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  "use strict";

Â  Â  Â  Â  // === 1. DOM ELEMANLARI ve AYARLAR ===
Â  Â  Â  Â  const ANA_RENK = "#5B86A5"; /* DEÄÄ°ÅTÄ°: YeÅŸil yerine yeni mavi */
Â  Â  Â  Â  const startStopButton = document.getElementById('startStopButton');
Â  Â  Â  Â  const captureButton = document.getElementById('captureButton');
Â  Â  Â  Â  const liveCanvas = document.getElementById('liveCanvas');
Â  Â  Â  Â  const analysisCanvas = document.getElementById('analysisCanvas');
Â  Â  Â  Â  const analysisDataPre = document.getElementById('analysisData');
Â  Â  Â  Â  const refWaveDataPre = document.getElementById('refWaveData');
Â  Â  Â  Â  const fftSlider = document.getElementById('fftSlider');
Â  Â  Â  Â  const liveInfo = document.getElementById('liveInfo');
Â  Â  Â  Â  const analysisInfo = document.getElementById('analysisInfo');
Â  Â  Â  Â Â 
Â  Â  Â  Â  const scrollSlider = document.getElementById('scrollSlider');
Â  Â  Â  Â  const showRefWaveCheck = document.getElementById('showRefWave');
Â  Â  Â  Â  const freqSlider = document.getElementById('freqSlider');
Â  Â  Â  Â  const ampSlider = document.getElementById('ampSlider');
Â  _ Â  Â Â 
Â  Â  Â  Â  const liveCtx = liveCanvas.getContext('d');
Â  Â  Â  Â  const analysisCtx = analysisCanvas.getContext('2d');

Â  Â  Â  Â  // === 2. DEÄÄ°ÅKENLER ===
Â  Â  Â  Â  let audioContext;
Â  Â  Â  Â  let analyser;
Â  Â  Â  Â  let sourceNode; // Mikrofon kaynaÄŸÄ±
Â  Â  Â  Â  let liveDataArray;Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  const CAPTURE_BUFFER_SIZE = 8192; // Yakalanacak toplam Ã¶rnek
Â  Â  Â  Â  const ANALYSIS_VIEW_WIDTH = 2048; // Ekranda bir anda gÃ¶sterilecek Ã¶rnek
Â  Â  Â  Â  let capturedDataBuffer = new Float32Array(CAPTURE_BUFFER_SIZE);Â 
Â  Â  Â  Â  let analysisOffset = 0; // KaydÄ±rma Ã§ubuÄŸundan gelen kayma miktarÄ±

Â  Â  Â  Â  let liveAnimationId;
Â  Â  Â  Â  let isListening = false;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const fftMap = [512, 1024, 2048, 4096, 8192, 16384];
Â  Â  Â  Â  let currentLiveFftSize = fftMap[fftSlider.value];Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  const canvasWidth = 600;
Â  Â  Â  Â  const canvasHeight = 200;
Â  Â  Â  Â  [liveCanvas, analysisCanvas].forEach(c => {
Â  Â  Â  Â  Â  Â  c.width = canvasWidth;
Â  Â  Â  Â  Â  Â  c.height = canvasHeight;
Â  Â  Â  Â  });

Â  Â  Â  Â  // === 3. Ã‡ALIÅMA MANTIÄI: MÄ°KROFON ===

Â  Â  Â  Â  async function toggleListening() {
Â  Â  Â  Â  Â  Â  if (isListening) {
Â  Â  Â  Â  Â  Â  Â  Â  stopProcessing();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // TarayÄ±cÄ±ya izin isteÄŸini burada gÃ¶nderir
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  audioContext = new (window.AudioContext || window.webkitAudioContext)();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ä°zin alÄ±ndÄ±ysa kod buraya devam eder
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sourceNode = audioContext.createMediaStreamSource(stream);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  analyser = audioContext.createAnalyser();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateLiveFftSize();Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sourceNode.connect(analyser);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isListening = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startStopButton.textContent = "ğŸ›‘ Durdur";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  captureButton.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  drawLiveWave();Â 
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('Mikrofon hatasÄ±:', err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (err.name === "NotAllowedError" || err.name === "PermissionDeniedError") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Mikrofon izni reddedildi. LÃ¼tfen tarayÄ±cÄ± ayarlarÄ±ndan izin verin.");
Â  Â  Â  Â  Â  Â  _ Â  Â  } else if (err.name === "NotFoundError") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â alert("Mikrofon bulunamadÄ±.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Bir hata oluÅŸtu: " + err.message + "\n\n(Bu kodun Ã§alÄ±ÅŸmasÄ± iÃ§in 'localhost' veya 'https' gerekir.)");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function stopProcessing() {
Â  Â  Â  Â  Â  Â  Â if (liveAnimationId) {
Â  Â  Â  Â  Â  Â  Â  Â  cancelAnimationFrame(liveAnimationId);
Â  Â  Â  Â  Â  Â  Â  Â  liveAnimationId = null;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  if (audioContext && audioContext.state !== 'closed') {
Â  Â  Â  Â  Â  Â  Â  Â  if (sourceNode && sourceNode.mediaStream) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sourceNode.mediaStream.getTracks().forEach(track => track.stop());
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  audioContext.close().catch(e => console.error(e));
Â  Â  Â  Â  Â  Â  Â  Â  audioContext = null;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  isListening = false;
Â  Â  Â  Â  Â  Â  startStopButton.textContent = "ğŸ™ï¸ Mikrofonu BaÅŸlat";
Â  Â  Â  Â  Â  Â  captureButton.disabled = true;
Â  Â  Â  Â  Â  Â  drawGrid(liveCtx, "AkÄ±ÅŸ Durdu. BaÅŸlat'a bas.");
Â  Â  Â  Â  }

Â  Â  Â  Â  // CanlÄ± akÄ±ÅŸÄ±n detayÄ±nÄ±/hÄ±zÄ±nÄ± gÃ¼nceller
Â  Â  Â  Â  function updateLiveFftSize() {
Â  Â  Â  Â  Â  Â  currentLiveFftSize = fftMap[fftSlider.value];
Â  Â  Â  Â  Â  Â  if (analyser) {
Â  Â  Â  Â  Â  Â  Â  Â  analyser.fftSize = currentLiveFftSize;
Â  Â  Â  Â  Â  Â  Â  Â  liveDataArray = new Float32Array(analyser.frequencyBinCount);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  liveInfo.textContent = `Detay (FFT): ${currentLiveFftSize}`;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // AnlÄ±k Sesi Yakala Fonksiyonu
Â  Â  Â  Â  function captureAudio() {
Â  Â  Â  Â  Â  Â  if (!isListening || !analyser) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // GeÃ§ici olarak FFT boyutunu YÃœKSELT
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  analyser.fftSize = CAPTURE_BUFFER_SIZE * 2;Â 
Â  Â  Â  Â  Â  Â  Â  Â  analyser.getFloatTimeDomainData(capturedDataBuffer);Â 
Â  Â  Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("FFT hatasÄ±:", e);
Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  // CanlÄ± akÄ±ÅŸ iÃ§in FFT boyutunu HEMEN geri ayarla
Â  Â  Â  Â  Â  Â  Â  Â  analyser.fftSize = currentLiveFftSize;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const totalTimeMs = (CAPTURE_BUFFER_SIZE / audioContext.sampleRate) * 1000;
Â  Â  Â  Â  Â  Â  analysisInfo.textContent = `Toplam Yakalanan SÃ¼re: ${totalTimeMs.toFixed(1)} ms`;

Â  Â  Â  Â  Â  Â  scrollSlider.max = CAPTURE_BUFFER_SIZE - ANALYSIS_VIEW_WIDTH;
Â  _ Â  Â  Â  Â  scrollSlider.value = 0;
Â  Â  Â  Â  Â  Â  analysisOffset = 0;

Â  Â  Â  Â  Â  Â  drawAnalysisWave();
Â  Â  Â  Â  }

Â  Â  Â  Â  // === 4. GÃ–RSELLEÅTÄ°RME VE Ã‡Ä°ZÄ°M ===
Â  Â  Â  Â Â 
Â  Â  Â  Â  function drawLiveWave() {
Â  Â  Â  Â  Â  Â  if (!isListening) return;
Â  Â  Â  Â  Â  Â  liveAnimationId = requestAnimationFrame(drawLiveWave);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  analyser.getFloatTimeDomainData(liveDataArray);Â 

Â  Â  Â  Â  Â  Â  liveCtx.fillStyle = '#FFFFFF'; /* Arka plan beyaz */
Â  Â  Â  Â  Â  Â  liveCtx.fillRect(0, 0, canvasWidth, canvasHeight);
Â  Â  Â  Â  Â  Â  drawGrid(liveCtx);
Â  Â  Â  Â  Â  Â  liveCtx.lineWidth = 2;
Â  Â  Â  Â  Â  Â  liveCtx.strokeStyle = ANA_RENK; /* Mavi dalga */
Â  Â  Â  Â  Â  Â  liveCtx.beginPath();

Â  Â  Â  Â  Â  Â  const sliceWidth = canvasWidth * 1.0 / liveDataArray.length;
Â  Â  Â  Â  Â  Â  let x = 0;

Â  Â  Â  Â  Â  Â  for (let i = 0; i < liveDataArray.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const v = liveDataArray[i];Â 
Â  Â  Â  Â  Â  Â  Â  Â  const y = (v * canvasHeight / 2) + (canvasHeight / 2);Â 

Â  Â  Â  Â  Â  Â  Â  Â  if (i === 0) liveCtx.moveTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  else liveCtx.lineTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  x += sliceWidth;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  liveCtx.lineTo(canvasWidth, canvasHeight / 2);
Â  Â  Â  Â  Â  Â  liveCtx.stroke();
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawAnalysisWave() {
Â  Â  Â  Â  Â  Â  analysisCtx.fillStyle = '#FFFFFF'; /* Arka plan beyaz */
Â  Â  Â  Â  Â  Â  analysisCtx.fillRect(0, 0, canvasWidth, canvasHeight);
Â  Â  Â  Â  Â  Â  drawGrid(analysisCtx, "Ä°ncelemek iÃ§in tÄ±kla");

Â  Â  Â  Â  Â  Â  // 1. Ana Yakalanan Ses DalgasÄ±
Â  Â  Â  Â  Â  Â  analysisCtx.lineWidth = 2;
Â  Â  Â  Â  Â  Â  analysisCtx.strokeStyle = 'rgb(255, 165, 0)'; // Turuncu-SarÄ± (Bu renk gÃ¼zel, kalsÄ±n)
Â  Â  Â  Â  Â  Â  analysisCtx.beginPath();

Â  Â  Â  Â  Â  Â  const sliceWidth = canvasWidth * 1.0 / ANALYSIS_VIEW_WIDTH;Â 
Â  Â  Â  Â  Â  Â  let x = 0;

Â  Â  Â  Â  Â  Â  for (let i = 0; i < ANALYSIS_VIEW_WIDTH; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dataIndex = analysisOffset + i;Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (dataIndex >= capturedDataBuffer.length) break;

Â  Â  Â  Â  Â  Â  Â  Â  const v = capturedDataBuffer[dataIndex];
Â  Â  Â  Â  Â  Â  Â  Â  const y = (v * canvasHeight / 2) + (canvasHeight / 2);

Â  Â  Â  Â  Â  Â  Â  Â  if (i === 0) analysisCtx.moveTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  else analysisCtx.lineTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  x += sliceWidth;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  analysisCtx.lineTo(canvasWidth, canvasHeight / 2);
Â  Â  Â  Â  Â  Â  analysisCtx.stroke();

Â  Â  Â  Â  Â  Â  // 2. Referans sinÃ¼s dalgasÄ± (varsa)
Â  Â  Â  Â  Â  Â  if (showRefWaveCheck.checked) {
Â  Â  Â  Â  Â  Â  Â  Â  drawReferenceSineWave();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function drawReferenceSineWave() {
Â  Â  Â  Â  Â  Â  const freq = parseFloat(freqSlider.value);Â 
Â  Â  Â  Â  Â  Â  const amp = parseFloat(ampSlider.value);Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  analysisCtx.lineWidth = 1;
Â  Â  Â  Â  Â  Â  analysisCtx.strokeStyle = 'rgb(255, 0, 255)'; // Pembe (Bu da kalsÄ±n, sarÄ± ile kontrastÄ± iyi)
Â  Â  Â  Â  Â  Â  analysisCtx.beginPath();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const sliceWidth = canvasWidth * 1.0 / ANALYSIS_VIEW_WIDTH;
Â  Â  Â  Â  Â  Â  let x = 0;

Â  Â  Â  Â  Â  Â  for (let i = 0; i < ANALYSIS_VIEW_WIDTH; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const t = i / ANALYSIS_VIEW_WIDTH;Â 
Â  Â  Â  Â  Â  Â  Â  Â  const v = amp * Math.sin(2 * Math.PI * freq * t);
Â  Â  Â  Â  Â  Â  Â  Â  const y = (v * canvasHeight / 2) + (canvasHeight / 2);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (i === 0) analysisCtx.moveTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  else analysisCtx.lineTo(x, y);
Â  Â  Â  Â  Â  Â  Â  Â  x += sliceWidth;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  analysisCtx.stroke();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const periyot = 1 / freq;
Â  Â  Â  Â  Â  Â  refWaveDataPre.textContent = `
Ayarlar:
Â  Frekans (f): ${freq.toFixed(1)} (DÃ¶ngÃ¼/Ekran)
Â  Genlik (A): ${amp.toFixed(2)}

Hesaplamalar:
Â  Periyot (T): ${periyot.toFixed(3)} (Ekran GeniÅŸliÄŸi / f)
Â  Dalga Denklemi:
Â  Â  y(t) = ${amp.toFixed(2)} * sin(2 * Ï€ * ${freq.toFixed(1)} * t)
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Izgara Ã‡izim Fonksiyonu
Â  Â  Â  Â  function drawGrid(ctx, message = null) {
Â  Â  Â  Â  Â  Â  ctx.lineWidth = 1;
Â  Â  Â  Â  Â  Â  ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)'; /* DEÄÄ°ÅTÄ°: YeÅŸil yerine aÃ§Ä±k gri Ä±zgara */
Â  Â  Â  Â  Â  Â  for (let x = 0; x < canvasWidth; x += 50) {
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvasHeight); ctx.stroke();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  for (let y = 0; y < canvasHeight; y += 50) {
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvasWidth, y); ctx.stroke();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)'; /* DEÄÄ°ÅTÄ°: Orta Ã§izgi iÃ§in biraz daha koyu gri */
Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.moveTo(0, canvasHeight / 2); ctx.lineTo(canvasWidth, canvasHeight / 2); ctx.stroke();
Â  Â  Â  Â  Â  Â  if (message) {
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = "rgba(0, 0, 0, 0.5)"; /* DEÄÄ°ÅTÄ°: Beyaz yerine koyu gri metin */
Â  Â  Â  Â  Â  Â  Â  Â  ctx.textAlign = "center";
Â  Â  Â  Â  Â  Â  Â  Â  ctx.font = "16px 'Segoe UI'";
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillText(message, canvasWidth / 2, canvasHeight / 2 - 20);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // === 5. TRÄ°GONOMETRÄ°K HESAPLAMA (EÄÄ°M/HIZ) ===

Â  Â  Â  Â  function analyzeClick(event) {
Â  Â  Â  Â  Â  Â  const rect = analysisCanvas.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  const x = event.clientX - rect.left;

Â  Â  Â  Â  Â  Â  const viewIndex = Math.round((x / canvasWidth) * ANALYSIS_VIEW_WIDTH);
Â  Â  Â  Â  Â  Â  const bufferIndex = analysisOffset + viewIndex;

Â  Â  Â  Â  Â  Â  if (!capturedDataBuffer || capturedDataBuffer[0] === 0 || bufferIndex >= CAPTURE_BUFFER_SIZE || bufferIndex < 1) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("LÃ¼tfen Ã¶nce 'AnlÄ±k Ses Yakala' butonuna basÄ±n.");
Â  Â  Â  Â  Â  Â  Â  Â  return;Â 
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const y_val = capturedDataBuffer[bufferIndex];
Â  Â  Â  Â  Â  Â  const y_prev = capturedDataBuffer[bufferIndex - 1];
Â  Â  Â  Â  Â  Â  const y_next = capturedDataBuffer[bufferIndex + 1];

Â  Â  Â  Â  Â  Â  const slope_m = (y_next - y_prev) / 2.0;
Â  Â  Â  Â  Â  Â  const angle_rad = Math.atan(slope_m);
Â  Â  Â  Â  Â  Â  const angle_deg = angle_rad * (180 / Math.PI);
Â  Â  Â  Â  Â  Â  const sin_val = Math.sin(angle_rad);
Â  Â  Â  Â  Â  Â  const cos_val = Math.cos(angle_rad);
Â  Â  Â  Â  Â  Â  const cot_val = 1.0 / slope_m;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const totalTimeMs = (CAPTURE_BUFFER_SIZE / audioContext.sampleRate) * 1000;
Â  Â  Â  Â  Â  Â  const clickTimeMs = (bufferIndex / CAPTURE_BUFFER_SIZE) * totalTimeMs;

Â  Â  Â  Â  Â  Â  analysisDataPre.textContent = `
TÄ±kladÄ±ÄŸÄ±n Nokta:
Â  Zaman (t): ${clickTimeMs.toFixed(2)} ms
Â  Genlik (y): ${y_val.toFixed(4)}

Nokta EÄŸim (TeÄŸet) Bilgileri:
Â  EÄŸim (m) - **AKIÅ HIZI**: ${slope_m.toFixed(4)}
Â  AÃ§Ä± (Î¸) [Radyan]: ${angle_rad.toFixed(4)}
Â  AÃ§Ä± (Î¸) [Derece]: ${angle_deg.toFixed(2)}

Trigonometrik DeÄŸerler:
Â  tan(Î¸) = ${slope_m.toFixed(4)}
Â  sin(Î¸) = ${sin_val.toFixed(4)}
Â  cos(Î¸) = ${cos_val.toFixed(4)}
Â  cot(Î¸) = ${cot_val.toFixed(4)}
Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  drawAnalysisWave();Â 
Â  Â  Â  Â  Â  Â  analysisCtx.fillStyle = 'red'; // KÄ±rmÄ±zÄ± nokta (iÅŸaretÃ§i) kalsÄ±n
Â  Â  Â  Â  Â  Â  analysisCtx.beginPath();
Â  Â  Â  Â  Â  Â  const canvas_y = (y_val * canvasHeight / 2) + (canvasHeight / 2);
Â  Â  Â  Â  Â  Â  analysisCtx.arc(x, canvas_y, 5, 0, 2 * Math.PI);Â 
Â  Â  Â  Â  Â  Â  analysisCtx.fill();
Â  Â  Â  Â  }

Â  Â  Â  Â  // === 6. OLAY DÄ°NLEYÄ°CÄ°LERÄ° VE AKORDÄ°YON ===
Â  Â  Â  Â Â 
Â  Â  Â  Â  startStopButton.addEventListener('click', toggleListening);
Â  Â  Â  Â  captureButton.addEventListener('click', captureAudio);
Â  Â  Â  Â  analysisCanvas.addEventListener('click', analyzeClick);
Â  Â  Â  Â Â 
Â  Â  Â  Â  fftSlider.addEventListener('input', updateLiveFftSize);

Â  Â  Â  Â  scrollSlider.addEventListener('input', (e) => {
Â  Â  Â  Â  Â  Â  analysisOffset = parseInt(e.target.value);
Â  Â  Â  Â  Â  Â  if (capturedDataBuffer[0] !== 0) drawAnalysisWave();Â 
Â  Â  Â  Â  });

Â  Â  Â  Â  [showRefWaveCheck, freqSlider, ampSlider].forEach(el => el.addEventListener('input', () => {
Â  Â  Â  Â  Â  Â  Â // Sadece veri varsa (veya checkbox kapalÄ±ysa) yeniden Ã§iz
Â  Â  Â  Â  Â  Â  Â if (capturedDataBuffer[0] !== 0 || !showRefWaveCheck.checked) drawAnalysisWave();
Â  Â  Â  Â  Â  Â  Â // Sadece referans dalga hesaplamasÄ±nÄ± checkbox aÃ§Ä±kken yap
Â  Â  Â  Â  Â  Â  Â if (showRefWaveCheck.checked) drawReferenceSineWave();
Â  Â  Â  Â  }));

Â  Â  Â  Â  document.querySelectorAll(".accordion").forEach(button => {
Â  Â  Â  Â  Â  Â  button.addEventListener("click", function() {
Â  Â  Â  Â  Â  Â  Â  Â  this.classList.toggle("active");
Â  Â  Â  Â  Â  Â  Â  Â  const panel = this.nextElementSibling;
Â  Â  Â  Â  Â  Â  Â  Â  if (panel.style.maxHeight) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  panel.style.maxHeight = null;
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  panel.style.maxHeight = panel.scrollHeight + "px";
Â  Â  Â  Â  _ Â  Â  }Â 
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  // Sayfa yÃ¼klendiÄŸinde varsayÄ±lan ekranÄ± Ã§iz
Â  Â  Â  Â  drawGrid(liveCtx, "BaÅŸlat'a bas.");
Â  Â  Â  Â  drawGrid(analysisCtx, "Yakalanan ses buraya gelir.");
Â  Â  </script>
</body>
</html>
